# 30. 二元配置分散分析
* 因子を2つ含むデータから、各因子における水準間の平均値の差を検定するための分析方法
* 一元配置分散分析と同じく、ポイントは「データ全体の平均値から因子の各水準の平均値がどのくらいずれているか」
* 1種類の条件で複数回実験を行ったデータの場合、`交互作用`の有無についても解析することができる

## 分散分析表の作成
| 因子 | 平方和 | 自由度 | 平均平方 | F値 |
| :-: | :-: | :-: | :-: | :-: |
| 因子A | 下記参照 | Aの水準数 - 1 | 平方和 ÷ 残差 | A ÷ 残差<br/>(平均平方) |
| 因子B | 下記参照 | Bの水準数 - 1 | 平方和 ÷ 自由度 | B ÷ 残差<br/>(平均平方) |
| 因子A×因子B<br/>(`交互作用`) | 下記参照 | A×B<br/>(自由度) | 平方和 ÷ 自由度 | A×B ÷ 残差<br/>(平均平方) |
| 残差 | `全体` - (`A`+`B`+`A×B`)<br/>(平方和) | `全体` - (`A`+`B`+`A×B`)<br/>(自由度) | 平方和 ÷ 自由度 | - |
| 全体 | 下記参照 | サンプルサイズ - 1 | - | - |

### `平方和`列
* 一元配置分散分析とだいたい同じ

#### `因子A(因子B)`
* データ全体の平均値からの因子Aの各水準の平均値のズレ
* 全体の平均値と各群の平均値との差を二乗したものに、各群のデータ数をかけたものの和
  * Σ (μ - X(bar))^2 × n
    * X(bar): 各群の平均値
    * n: 各群のデータ数

#### `因子A×因子B`
* (データ全体の平均値からの因子A×因子Bの各水準の平均値のズレ) - (`因子Aの平方和` + `因子Bの平方和`)
  * {Σ (μ - X(bar))^2 × n} - (ΣA + ΣB)

#### `全体`
* データ全体の平均値からの各データのズレ
* 全体の平均値とすべてのデータとの差の二乗和を求める
  * Σ (μ - x)^2
  * μ: 母平均
  * x: 各データ

### `F値`
* `因子毎の平均平方 ÷ 残差の平均平方`(比)
  * 各F値を用いて検定を行う
  * F分布を用いる

## 統計量Fによる検定
* 因子A(因子B)の大小によって平均に差がある(ない)

## 各水準の母平均の信頼区間
![](./img/202.PNG)
* 因子AとBの交互作用が有意である場合、Aにおける水準jかつBにおける水準kの母平均の信頼区間の算出式
  * xjk(bar): 水準jの標本平均
  * df(E): 残差の自由度
  * V(E): 残差の平方平均
  * njk: 水準jのサンプルサイズ
* 交互作用が有意でない場合、因子AとBを分けて考える(一元配置分散分析と同じ式)

## 繰り返しのない二元配置分散分析
* 1つの水準に含まれるデータが1つである二元配置分散分析のこと
* `交互作用`が算出できない(交互作用を残差変動から分離できない)

### 分散分析表における繰り返しがあるものとの違い
* 因子A×因子B 行がない
* 残差の平方和 = `全体の平方和` - ( `Aの平方和` + `Bの平方和` )
* 残差の自由度 = `全体の自由度` - ( `Aの自由度` + `Bの自由度` )

## 交互作用とは
* 2つの因子が組み合わさることで初めて現れる相乗効果のこと
* 交互作用による効果のことを`交互作用効果`という
* 交互作用に対して、1つの因子に絞った場合の効果のことを`主効果`という

### 交互作用図
![](./img/203.PNG)
* 交互作用図の例
* ここでは、土の種類によって肥料の量に対する収量の変化が異なっていることを`交互作用効果`という

![](./img/204.PNG)
* 交互作用が有意ではない場合、グラフは平行になる

### `交互作用効果`があるかどうかの検定
* 分散分析表の交互作用の行で検定
* 帰無仮説は「因子Aと因子Bによる結果への影響はない（因子Aと因子Bの交互作用効果はない）」